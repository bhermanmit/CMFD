<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMFD: /home/bherman/Documents/PhD/CMFD/src/xml_cmfd.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMFD</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>      </li>
      <li class="navelem"><a class="el" href="dir_afcdd5e0edc0b371418ed6fb21b6270d.html">bherman</a>      </li>
      <li class="navelem"><a class="el" href="dir_3201ddb1ceaf11262981f79926d55b34.html">Documents</a>      </li>
      <li class="navelem"><a class="el" href="dir_8618e8944a8ba0368b5596bf6a0bf90b.html">PhD</a>      </li>
      <li class="navelem"><a class="el" href="dir_0e285d84ac0545df775f743b98d4c43a.html">CMFD</a>      </li>
      <li class="navelem"><a class="el" href="dir_6146a08e605ebd85439d35f097622cfc.html">src</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>xml_cmfd.F90</h1>  </div>
</div>
<div class="contents">
<a href="xml__cmfd_8F90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacexml__data__cmfd__t.html">00001</a> <span class="keyword">module</span> xml_data_cmfd_t
<a name="l00002"></a>00002    use <span class="keywordflow">READ_XML_PRIMITIVES</span>
<a name="l00003"></a>00003    use <span class="keywordflow">WRITE_XML_PRIMITIVES</span>
<a name="l00004"></a>00004    use <span class="keywordflow">XMLPARSE</span>
<a name="l00005"></a>00005    <span class="keyword">implicit none</span>
<a name="l00006"></a><a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">00006</a>    <span class="keywordtype">integer</span>, <span class="keywordtype">private</span> :: lurep_
<a name="l00007"></a><a class="code" href="namespacexml__data__cmfd__t.html#a5e231a5441a700d365de0bde8ff1b10a">00007</a>    <span class="keywordtype">logical</span>, <span class="keywordtype">private</span> :: strict_
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html">00009</a> <span class="keyword">type</span> <a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html">geometry_xml</a>
<a name="l00010"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a579a08ea289174e75b78f542bced1658">00010</a>    <span class="keywordtype">integer</span>                                         :: nx
<a name="l00011"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a511a6b8aa9364a8137053e814007c3c6">00011</a>    <span class="keywordtype">integer</span>                                         :: ny
<a name="l00012"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#ac1ffbe918c25948396ce22965e7c1b94">00012</a>    <span class="keywordtype">integer</span>                                         :: nz
<a name="l00013"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a9113280b88fefeaa2aabca51e395cbb0">00013</a>    <span class="keywordtype">integer</span>                                         :: ng
<a name="l00014"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#aac19483c6c24e8cabbdfa1ab8e89255a">00014</a>    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>                  :: mesh =&gt; null()
<a name="l00015"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#acba3c85858d516dc101bf61e8337a0c3">00015</a>    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>                  :: xgrid =&gt; null()
<a name="l00016"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#ababd910cc93f1fd009935b3c3d7984c5">00016</a>    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>                  :: ygrid =&gt; null()
<a name="l00017"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#afc7efefe5e2aceb57271923883c46427">00017</a>    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>                  :: zgrid =&gt; null()
<a name="l00018"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a7aa6217d24f4301276cfd04cb44093ce">00018</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: uniform =&gt; null()
<a name="l00019"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#abf68ff53ba741eb38acd68bca1dfd1d1">00019</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: dx =&gt; null()
<a name="l00020"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a9f646b485cf8438a5d23fdb855cb3454">00020</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: dy =&gt; null()
<a name="l00021"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#a137444f8bbe4b961220d5658bc3d239e">00021</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: dz =&gt; null()
<a name="l00022"></a><a class="code" href="typexml__data__cmfd__t_1_1geometry__xml.html#aef0568ae5deb8e12e66573a5a3e0aff4">00022</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: bc =&gt; null()
<a name="l00023"></a>00023 <span class="keyword">end type geometry_xml</span>
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html">00025</a> <span class="keyword">type</span> <a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html">mat_xml</a>
<a name="l00026"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#a3d42622eabb5aa0ff5b820815f488208">00026</a>    <span class="keywordtype">integer</span>                                         :: uid
<a name="l00027"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#a3651521e05d2b478891143e779bd6307">00027</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: totalxs =&gt; null()
<a name="l00028"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#a3e827721461c3dafd687891b5954aaa2">00028</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: scattxs =&gt; null()
<a name="l00029"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#ad1ec672fbc7238d0a7628f039dba9608">00029</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: nfissxs =&gt; null()
<a name="l00030"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#ad099aded7f6cfa91f2c8289e25174dda">00030</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: diffcoef =&gt; null()
<a name="l00031"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#a56d6f9f821964854477715c11354bdd9">00031</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: chi =&gt; null()
<a name="l00032"></a><a class="code" href="typexml__data__cmfd__t_1_1mat__xml.html#aeb7bd3fab06591850e5218efef000b1b">00032</a>    <span class="keywordtype">real(kind=kind(1.0d0))</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>   :: remxs =&gt; null()
<a name="l00033"></a>00033 <span class="keyword">end type mat_xml</span>
<a name="l00034"></a><a class="code" href="namespacexml__data__cmfd__t.html#a56a655f48acfec2ce36e98deadce83f8">00034</a>    <span class="keywordtype">type(geometry_xml)</span>                              :: geometry
<a name="l00035"></a><a class="code" href="namespacexml__data__cmfd__t.html#a2aa66ea95cd00522b90f06cbcb13baab">00035</a>    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span>            :: mat =&gt; null()
<a name="l00036"></a>00036 <span class="keyword">contains</span>
<a name="l00037"></a><a class="code" href="namespacexml__data__cmfd__t.html#ad5b3f3da6c4fc4d71749c56a7cc955da">00037</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#ad5b3f3da6c4fc4d71749c56a7cc955da">read_xml_type_geometry_xml_array</a>( &amp;
<a name="l00038"></a>00038       info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00039"></a>00039       dvar, has_dvar )
<a name="l00040"></a>00040    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00041"></a>00041    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(inout)</span>                 :: tag
<a name="l00042"></a>00042    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                          :: endtag
<a name="l00043"></a>00043    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: attribs
<a name="l00044"></a>00044    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: noattribs
<a name="l00045"></a>00045    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>   :: data
<a name="l00046"></a>00046    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: nodata
<a name="l00047"></a>00047    <span class="keywordtype">type(geometry_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: dvar
<a name="l00048"></a>00048    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                       :: has_dvar
<a name="l00049"></a>00049 
<a name="l00050"></a>00050    <span class="keywordtype">integer</span>                                      :: newsize
<a name="l00051"></a>00051    <span class="keywordtype">type(geometry_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: newvar
<a name="l00052"></a>00052 
<a name="l00053"></a>00053    newsize = <span class="keyword">size</span>(dvar) + 1
<a name="l00054"></a>00054    <span class="keyword">allocate</span>( newvar(1:newsize) )
<a name="l00055"></a>00055    newvar(1:newsize-1) = dvar
<a name="l00056"></a>00056    <span class="keyword">deallocate</span>( dvar )
<a name="l00057"></a>00057    dvar =&gt; newvar
<a name="l00058"></a>00058 
<a name="l00059"></a>00059    call <a class="code" href="namespacexml__data__cmfd__t.html#a7bed203907e75d7172c9531371471832">read_xml_type_geometry_xml</a>( info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00060"></a>00060               dvar(newsize), has_dvar )
<a name="l00061"></a>00061 <span class="keyword">end subroutine read_xml_type_geometry_xml_array</span>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="namespacexml__data__cmfd__t.html#a7bed203907e75d7172c9531371471832">00063</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a7bed203907e75d7172c9531371471832">read_xml_type_geometry_xml</a>( info, starttag, endtag, attribs, noattribs, data, nodata, &amp;
<a name="l00064"></a>00064               dvar, has_dvar )
<a name="l00065"></a>00065    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00066"></a>00066    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: starttag
<a name="l00067"></a>00067    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                          :: endtag
<a name="l00068"></a>00068    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: attribs
<a name="l00069"></a>00069    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: noattribs
<a name="l00070"></a>00070    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>   :: data
<a name="l00071"></a>00071    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: nodata
<a name="l00072"></a>00072    <span class="keywordtype">type(geometry_xml)</span>, <span class="keywordtype">intent(inout)</span>  :: dvar
<a name="l00073"></a>00073    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                       :: has_dvar
<a name="l00074"></a>00074 
<a name="l00075"></a>00075    <span class="keywordtype">integer</span>                                      :: att_
<a name="l00076"></a>00076    <span class="keywordtype">integer</span>                                      :: noatt_
<a name="l00077"></a>00077    <span class="keywordtype">logical</span>                                      :: error
<a name="l00078"></a>00078    <span class="keywordtype">logical</span>                                      :: endtag_org
<a name="l00079"></a>00079    <span class="keywordtype">character(len=len(starttag))</span>                 :: tag
<a name="l00080"></a>00080    <span class="keywordtype">logical</span>                                         :: has_nx
<a name="l00081"></a>00081    <span class="keywordtype">logical</span>                                         :: has_ny
<a name="l00082"></a>00082    <span class="keywordtype">logical</span>                                         :: has_nz
<a name="l00083"></a>00083    <span class="keywordtype">logical</span>                                         :: has_ng
<a name="l00084"></a>00084    <span class="keywordtype">logical</span>                                         :: has_mesh
<a name="l00085"></a>00085    <span class="keywordtype">logical</span>                                         :: has_xgrid
<a name="l00086"></a>00086    <span class="keywordtype">logical</span>                                         :: has_ygrid
<a name="l00087"></a>00087    <span class="keywordtype">logical</span>                                         :: has_zgrid
<a name="l00088"></a>00088    <span class="keywordtype">logical</span>                                         :: has_uniform
<a name="l00089"></a>00089    <span class="keywordtype">logical</span>                                         :: has_dx
<a name="l00090"></a>00090    <span class="keywordtype">logical</span>                                         :: has_dy
<a name="l00091"></a>00091    <span class="keywordtype">logical</span>                                         :: has_dz
<a name="l00092"></a>00092    <span class="keywordtype">logical</span>                                         :: has_bc
<a name="l00093"></a>00093    has_nx                               = .false.
<a name="l00094"></a>00094    has_ny                               = .false.
<a name="l00095"></a>00095    has_nz                               = .false.
<a name="l00096"></a>00096    has_ng                               = .false.
<a name="l00097"></a>00097    has_mesh                             = .false.
<a name="l00098"></a>00098    has_xgrid                            = .false.
<a name="l00099"></a>00099    has_ygrid                            = .false.
<a name="l00100"></a>00100    has_zgrid                            = .false.
<a name="l00101"></a>00101    has_uniform                          = .false.
<a name="l00102"></a>00102    has_dx                               = .false.
<a name="l00103"></a>00103    has_dy                               = .false.
<a name="l00104"></a>00104    has_dz                               = .false.
<a name="l00105"></a>00105    has_bc                               = .false.
<a name="l00106"></a>00106    call <a class="code" href="namespacexml__data__cmfd__t.html#a7bfa6408e1f273a1458b2008a8362b58">init_xml_type_geometry_xml</a>(dvar)
<a name="l00107"></a>00107    has_dvar = .true.
<a name="l00108"></a>00108    error  = .false.
<a name="l00109"></a>00109    att_   = 0
<a name="l00110"></a>00110    noatt_ = noattribs+1
<a name="l00111"></a>00111    endtag_org = endtag
<a name="l00112"></a>00112    <span class="keyword">do</span>
<a name="l00113"></a>00113       <span class="keyword">if</span> ( nodata /= 0 ) <span class="keyword">then</span>
<a name="l00114"></a>00114          noattribs = 0
<a name="l00115"></a>00115          tag = starttag
<a name="l00116"></a>00116       elseif ( att_ &lt; noatt_ .and. noatt_ &gt; 1 ) <span class="keyword">then</span>
<a name="l00117"></a>00117          att_      = att_ + 1
<a name="l00118"></a>00118          <span class="keyword">if</span> ( att_ &lt;= noatt_-1 ) <span class="keyword">then</span>
<a name="l00119"></a>00119             tag       = attribs(1,att_)
<a name="l00120"></a>00120             <span class="keyword">data</span>(1)   = attribs(2,att_)
<a name="l00121"></a>00121             noattribs = 0
<a name="l00122"></a>00122             nodata    = 1
<a name="l00123"></a>00123             endtag    = .false.
<a name="l00124"></a>00124          <span class="keyword">else</span>
<a name="l00125"></a>00125             tag       = starttag
<a name="l00126"></a>00126             noattribs = 0
<a name="l00127"></a>00127             nodata    = 0
<a name="l00128"></a>00128             endtag    = .true.
<a name="l00129"></a>00129             cycle
<a name="l00130"></a>00130          <span class="keyword">endif</span>
<a name="l00131"></a>00131       <span class="keyword">else</span>
<a name="l00132"></a>00132          <span class="keyword">if</span> ( endtag_org ) <span class="keyword">then</span>
<a name="l00133"></a>00133             return
<a name="l00134"></a>00134          <span class="keyword">else</span>
<a name="l00135"></a>00135             call xml_get( info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata )
<a name="l00136"></a>00136             <span class="keyword">if</span> ( xml_error(info) ) <span class="keyword">then</span>
<a name="l00137"></a>00137                <span class="keyword">write</span>(<a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">lurep_</a>,*) <span class="stringliteral">&#39;Error reading input file!&#39;</span>
<a name="l00138"></a>00138                error = .true.
<a name="l00139"></a>00139                return
<a name="l00140"></a>00140             <span class="keyword">endif</span>
<a name="l00141"></a>00141          <span class="keyword">endif</span>
<a name="l00142"></a>00142       <span class="keyword">endif</span>
<a name="l00143"></a>00143       <span class="keyword">if</span> ( endtag .and. tag == starttag ) <span class="keyword">then</span>
<a name="l00144"></a>00144          exit
<a name="l00145"></a>00145       <span class="keyword">endif</span>
<a name="l00146"></a>00146       <span class="keyword">if</span> ( endtag .and. noattribs == 0 ) <span class="keyword">then</span>
<a name="l00147"></a>00147          <span class="keyword">if</span> ( xml_ok(info) ) <span class="keyword">then</span>
<a name="l00148"></a>00148             cycle
<a name="l00149"></a>00149          <span class="keyword">else</span>
<a name="l00150"></a>00150             exit
<a name="l00151"></a>00151          <span class="keyword">endif</span>
<a name="l00152"></a>00152       <span class="keyword">endif</span>
<a name="l00153"></a>00153       <span class="keyword">select</span> <span class="keyword">case</span>( tag )
<a name="l00154"></a>00154       <span class="keyword">case</span>(<span class="stringliteral">&#39;nx&#39;</span>)
<a name="l00155"></a>00155          call read_xml_integer( &amp;
<a name="l00156"></a>00156             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00157"></a>00157             dvar%nx, has_nx )
<a name="l00158"></a>00158       <span class="keyword">case</span>(<span class="stringliteral">&#39;ny&#39;</span>)
<a name="l00159"></a>00159          call read_xml_integer( &amp;
<a name="l00160"></a>00160             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00161"></a>00161             dvar%ny, has_ny )
<a name="l00162"></a>00162       <span class="keyword">case</span>(<span class="stringliteral">&#39;nz&#39;</span>)
<a name="l00163"></a>00163          call read_xml_integer( &amp;
<a name="l00164"></a>00164             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00165"></a>00165             dvar%nz, has_nz )
<a name="l00166"></a>00166       <span class="keyword">case</span>(<span class="stringliteral">&#39;ng&#39;</span>)
<a name="l00167"></a>00167          call read_xml_integer( &amp;
<a name="l00168"></a>00168             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00169"></a>00169             dvar%ng, has_ng )
<a name="l00170"></a>00170       <span class="keyword">case</span>(<span class="stringliteral">&#39;mesh&#39;</span>)
<a name="l00171"></a>00171          call read_xml_integer_array( &amp;
<a name="l00172"></a>00172             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00173"></a>00173             dvar%mesh, has_mesh )
<a name="l00174"></a>00174       <span class="keyword">case</span>(<span class="stringliteral">&#39;xgrid&#39;</span>)
<a name="l00175"></a>00175          call read_xml_integer_array( &amp;
<a name="l00176"></a>00176             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00177"></a>00177             dvar%xgrid, has_xgrid )
<a name="l00178"></a>00178       <span class="keyword">case</span>(<span class="stringliteral">&#39;ygrid&#39;</span>)
<a name="l00179"></a>00179          call read_xml_integer_array( &amp;
<a name="l00180"></a>00180             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00181"></a>00181             dvar%ygrid, has_ygrid )
<a name="l00182"></a>00182       <span class="keyword">case</span>(<span class="stringliteral">&#39;zgrid&#39;</span>)
<a name="l00183"></a>00183          call read_xml_integer_array( &amp;
<a name="l00184"></a>00184             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00185"></a>00185             dvar%zgrid, has_zgrid )
<a name="l00186"></a>00186       <span class="keyword">case</span>(<span class="stringliteral">&#39;uniform&#39;</span>)
<a name="l00187"></a>00187          call read_xml_double_array( &amp;
<a name="l00188"></a>00188             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00189"></a>00189             dvar%uniform, has_uniform )
<a name="l00190"></a>00190       <span class="keyword">case</span>(<span class="stringliteral">&#39;dx&#39;</span>)
<a name="l00191"></a>00191          call read_xml_double_array( &amp;
<a name="l00192"></a>00192             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00193"></a>00193             dvar%dx, has_dx )
<a name="l00194"></a>00194       <span class="keyword">case</span>(<span class="stringliteral">&#39;dy&#39;</span>)
<a name="l00195"></a>00195          call read_xml_double_array( &amp;
<a name="l00196"></a>00196             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00197"></a>00197             dvar%dy, has_dy )
<a name="l00198"></a>00198       <span class="keyword">case</span>(<span class="stringliteral">&#39;dz&#39;</span>)
<a name="l00199"></a>00199          call read_xml_double_array( &amp;
<a name="l00200"></a>00200             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00201"></a>00201             dvar%dz, has_dz )
<a name="l00202"></a>00202       <span class="keyword">case</span>(<span class="stringliteral">&#39;bc&#39;</span>)
<a name="l00203"></a>00203          call read_xml_double_array( &amp;
<a name="l00204"></a>00204             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00205"></a>00205             dvar%bc, has_bc )
<a name="l00206"></a>00206       <span class="keyword">case</span> (<span class="stringliteral">&#39;comment&#39;</span>, <span class="stringliteral">&#39;!--&#39;</span>)
<a name="l00207"></a>00207          <span class="comment">! Simply ignore</span>
<a name="l00208"></a>00208       <span class="keyword">case</span> default
<a name="l00209"></a>00209          <span class="keyword">if</span> ( <a class="code" href="namespacexml__data__cmfd__t.html#a5e231a5441a700d365de0bde8ff1b10a">strict_</a> ) <span class="keyword">then</span>
<a name="l00210"></a>00210             error = .true.
<a name="l00211"></a>00211             call xml_report_errors( info, &amp;
<a name="l00212"></a>00212                <span class="stringliteral">&#39;Unknown or wrongly placed tag: &#39;</span> // trim(tag))
<a name="l00213"></a>00213          <span class="keyword">endif</span>
<a name="l00214"></a>00214       <span class="keyword">end select</span>
<a name="l00215"></a>00215       nodata = 0
<a name="l00216"></a>00216       <span class="keyword">if</span> ( .not. xml_ok(info) ) exit
<a name="l00217"></a>00217    <span class="keyword">end do</span>
<a name="l00218"></a>00218    <span class="keyword">if</span> ( .not. has_nx ) <span class="keyword">then</span>
<a name="l00219"></a>00219       has_dvar = .false.
<a name="l00220"></a>00220       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on nx&#39;</span>)
<a name="l00221"></a>00221    <span class="keyword">endif</span>
<a name="l00222"></a>00222    <span class="keyword">if</span> ( .not. has_ny ) <span class="keyword">then</span>
<a name="l00223"></a>00223       has_dvar = .false.
<a name="l00224"></a>00224       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on ny&#39;</span>)
<a name="l00225"></a>00225    <span class="keyword">endif</span>
<a name="l00226"></a>00226    <span class="keyword">if</span> ( .not. has_nz ) <span class="keyword">then</span>
<a name="l00227"></a>00227       has_dvar = .false.
<a name="l00228"></a>00228       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on nz&#39;</span>)
<a name="l00229"></a>00229    <span class="keyword">endif</span>
<a name="l00230"></a>00230    <span class="keyword">if</span> ( .not. has_ng ) <span class="keyword">then</span>
<a name="l00231"></a>00231       has_dvar = .false.
<a name="l00232"></a>00232       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on ng&#39;</span>)
<a name="l00233"></a>00233    <span class="keyword">endif</span>
<a name="l00234"></a>00234    <span class="keyword">if</span> ( .not. has_mesh ) <span class="keyword">then</span>
<a name="l00235"></a>00235       has_dvar = .false.
<a name="l00236"></a>00236       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on mesh&#39;</span>)
<a name="l00237"></a>00237    <span class="keyword">endif</span>
<a name="l00238"></a>00238    <span class="keyword">if</span> ( .not. has_xgrid ) <span class="keyword">then</span>
<a name="l00239"></a>00239       has_dvar = .false.
<a name="l00240"></a>00240       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on xgrid&#39;</span>)
<a name="l00241"></a>00241    <span class="keyword">endif</span>
<a name="l00242"></a>00242    <span class="keyword">if</span> ( .not. has_ygrid ) <span class="keyword">then</span>
<a name="l00243"></a>00243       has_dvar = .false.
<a name="l00244"></a>00244       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on ygrid&#39;</span>)
<a name="l00245"></a>00245    <span class="keyword">endif</span>
<a name="l00246"></a>00246    <span class="keyword">if</span> ( .not. has_zgrid ) <span class="keyword">then</span>
<a name="l00247"></a>00247       has_dvar = .false.
<a name="l00248"></a>00248       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on zgrid&#39;</span>)
<a name="l00249"></a>00249    <span class="keyword">endif</span>
<a name="l00250"></a>00250    <span class="keyword">if</span> ( .not. has_uniform ) <span class="keyword">then</span>
<a name="l00251"></a>00251       has_dvar = .false.
<a name="l00252"></a>00252       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on uniform&#39;</span>)
<a name="l00253"></a>00253    <span class="keyword">endif</span>
<a name="l00254"></a>00254    <span class="keyword">if</span> ( .not. has_dx ) <span class="keyword">then</span>
<a name="l00255"></a>00255       has_dvar = .false.
<a name="l00256"></a>00256       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on dx&#39;</span>)
<a name="l00257"></a>00257    <span class="keyword">endif</span>
<a name="l00258"></a>00258    <span class="keyword">if</span> ( .not. has_dy ) <span class="keyword">then</span>
<a name="l00259"></a>00259       has_dvar = .false.
<a name="l00260"></a>00260       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on dy&#39;</span>)
<a name="l00261"></a>00261    <span class="keyword">endif</span>
<a name="l00262"></a>00262    <span class="keyword">if</span> ( .not. has_dz ) <span class="keyword">then</span>
<a name="l00263"></a>00263       has_dvar = .false.
<a name="l00264"></a>00264       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on dz&#39;</span>)
<a name="l00265"></a>00265    <span class="keyword">endif</span>
<a name="l00266"></a>00266    <span class="keyword">if</span> ( .not. has_bc ) <span class="keyword">then</span>
<a name="l00267"></a>00267       has_dvar = .false.
<a name="l00268"></a>00268       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on bc&#39;</span>)
<a name="l00269"></a>00269    <span class="keyword">endif</span>
<a name="l00270"></a>00270 <span class="keyword">end subroutine read_xml_type_geometry_xml</span>
<a name="l00271"></a><a class="code" href="namespacexml__data__cmfd__t.html#a1605fd4137ddf214b7ab508668a24a5a">00271</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a1605fd4137ddf214b7ab508668a24a5a">init_xml_type_geometry_xml_array</a>( dvar )
<a name="l00272"></a>00272    <span class="keywordtype">type(geometry_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: dvar
<a name="l00273"></a>00273    <span class="keyword">if</span> ( <span class="keyword">associated</span>( dvar ) ) <span class="keyword">then</span>
<a name="l00274"></a>00274       <span class="keyword">deallocate</span>( dvar )
<a name="l00275"></a>00275    <span class="keyword">endif</span>
<a name="l00276"></a>00276    <span class="keyword">allocate</span>( dvar(0) )
<a name="l00277"></a>00277 <span class="keyword">end subroutine init_xml_type_geometry_xml_array</span>
<a name="l00278"></a><a class="code" href="namespacexml__data__cmfd__t.html#a7bfa6408e1f273a1458b2008a8362b58">00278</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a7bfa6408e1f273a1458b2008a8362b58">init_xml_type_geometry_xml</a>(dvar)
<a name="l00279"></a>00279    <span class="keywordtype">type(geometry_xml)</span> :: dvar
<a name="l00280"></a>00280 <span class="keyword">end subroutine init_xml_type_geometry_xml</span>
<a name="l00281"></a><a class="code" href="namespacexml__data__cmfd__t.html#af606c558890f68682e991a3a33a4702a">00281</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#af606c558890f68682e991a3a33a4702a">write_xml_type_geometry_xml_array</a>( &amp;
<a name="l00282"></a>00282       info, tag, indent, dvar )
<a name="l00283"></a>00283    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00284"></a>00284    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: tag
<a name="l00285"></a>00285    <span class="keywordtype">integer</span>                                         :: indent
<a name="l00286"></a>00286    <span class="keywordtype">type(geometry_xml)</span>, <span class="keywordtype">dimension(:)</span>        :: dvar
<a name="l00287"></a>00287    <span class="keywordtype">integer</span>                                         :: i
<a name="l00288"></a>00288    <span class="keyword">do</span> i = 1,<span class="keyword">size</span>(dvar)
<a name="l00289"></a>00289        call <a class="code" href="namespacexml__data__cmfd__t.html#ab1767278ec3e20d9e79cdbebe03ff933">write_xml_type_geometry_xml</a>( info, tag, indent, dvar(i) )
<a name="l00290"></a>00290    <span class="keyword">enddo</span>
<a name="l00291"></a>00291 <span class="keyword">end subroutine write_xml_type_geometry_xml_array</span>
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="namespacexml__data__cmfd__t.html#ab1767278ec3e20d9e79cdbebe03ff933">00293</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#ab1767278ec3e20d9e79cdbebe03ff933">write_xml_type_geometry_xml</a>( &amp;
<a name="l00294"></a>00294       info, tag, indent, dvar )
<a name="l00295"></a>00295    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00296"></a>00296    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: tag
<a name="l00297"></a>00297    <span class="keywordtype">integer</span>                                         :: indent
<a name="l00298"></a>00298    <span class="keywordtype">type(geometry_xml)</span>                      :: dvar
<a name="l00299"></a>00299    <span class="keywordtype">character(len=100)</span>                              :: indentation
<a name="l00300"></a>00300    indentation = <span class="stringliteral">&#39; &#39;</span>
<a name="l00301"></a>00301    <span class="keyword">write</span>(info%lun, <span class="stringliteral">&#39;(4a)&#39;</span> ) indentation(1:min(indent,100)),&amp;
<a name="l00302"></a>00302        <span class="stringliteral">&#39;&lt;&#39;</span>,trim(tag), <span class="stringliteral">&#39;&gt;&#39;</span>
<a name="l00303"></a>00303    call write_to_xml_integer( info, <span class="stringliteral">&#39;nx&#39;</span>, indent+3, dvar%nx)
<a name="l00304"></a>00304    call write_to_xml_integer( info, <span class="stringliteral">&#39;ny&#39;</span>, indent+3, dvar%ny)
<a name="l00305"></a>00305    call write_to_xml_integer( info, <span class="stringliteral">&#39;nz&#39;</span>, indent+3, dvar%nz)
<a name="l00306"></a>00306    call write_to_xml_integer( info, <span class="stringliteral">&#39;ng&#39;</span>, indent+3, dvar%ng)
<a name="l00307"></a>00307    call write_to_xml_integer_array( info, <span class="stringliteral">&#39;mesh&#39;</span>, indent+3, dvar%mesh)
<a name="l00308"></a>00308    call write_to_xml_integer_array( info, <span class="stringliteral">&#39;xgrid&#39;</span>, indent+3, dvar%xgrid)
<a name="l00309"></a>00309    call write_to_xml_integer_array( info, <span class="stringliteral">&#39;ygrid&#39;</span>, indent+3, dvar%ygrid)
<a name="l00310"></a>00310    call write_to_xml_integer_array( info, <span class="stringliteral">&#39;zgrid&#39;</span>, indent+3, dvar%zgrid)
<a name="l00311"></a>00311    call write_to_xml_double_array( info, <span class="stringliteral">&#39;uniform&#39;</span>, indent+3, dvar%uniform)
<a name="l00312"></a>00312    call write_to_xml_double_array( info, <span class="stringliteral">&#39;dx&#39;</span>, indent+3, dvar%dx)
<a name="l00313"></a>00313    call write_to_xml_double_array( info, <span class="stringliteral">&#39;dy&#39;</span>, indent+3, dvar%dy)
<a name="l00314"></a>00314    call write_to_xml_double_array( info, <span class="stringliteral">&#39;dz&#39;</span>, indent+3, dvar%dz)
<a name="l00315"></a>00315    call write_to_xml_double_array( info, <span class="stringliteral">&#39;bc&#39;</span>, indent+3, dvar%bc)
<a name="l00316"></a>00316    <span class="keyword">write</span>(info%lun,<span class="stringliteral">&#39;(4a)&#39;</span>) indentation(1:min(indent,100)), &amp;
<a name="l00317"></a>00317        <span class="stringliteral">&#39;&lt;/&#39;</span> //trim(tag) // <span class="stringliteral">&#39;&gt;&#39;</span>
<a name="l00318"></a>00318 <span class="keyword">end subroutine write_xml_type_geometry_xml</span>
<a name="l00319"></a>00319 
<a name="l00320"></a><a class="code" href="namespacexml__data__cmfd__t.html#aa6889fdae9a646681ce5e8040ebe18f3">00320</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#aa6889fdae9a646681ce5e8040ebe18f3">read_xml_type_mat_xml_array</a>( &amp;
<a name="l00321"></a>00321       info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00322"></a>00322       dvar, has_dvar )
<a name="l00323"></a>00323    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00324"></a>00324    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(inout)</span>                 :: tag
<a name="l00325"></a>00325    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                          :: endtag
<a name="l00326"></a>00326    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: attribs
<a name="l00327"></a>00327    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: noattribs
<a name="l00328"></a>00328    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>   :: data
<a name="l00329"></a>00329    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: nodata
<a name="l00330"></a>00330    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: dvar
<a name="l00331"></a>00331    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                       :: has_dvar
<a name="l00332"></a>00332 
<a name="l00333"></a>00333    <span class="keywordtype">integer</span>                                      :: newsize
<a name="l00334"></a>00334    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: newvar
<a name="l00335"></a>00335 
<a name="l00336"></a>00336    newsize = <span class="keyword">size</span>(dvar) + 1
<a name="l00337"></a>00337    <span class="keyword">allocate</span>( newvar(1:newsize) )
<a name="l00338"></a>00338    newvar(1:newsize-1) = dvar
<a name="l00339"></a>00339    <span class="keyword">deallocate</span>( dvar )
<a name="l00340"></a>00340    dvar =&gt; newvar
<a name="l00341"></a>00341 
<a name="l00342"></a>00342    call <a class="code" href="namespacexml__data__cmfd__t.html#a5ee441126ddc3adac07dabc8d941c2ec">read_xml_type_mat_xml</a>( info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00343"></a>00343               dvar(newsize), has_dvar )
<a name="l00344"></a>00344 <span class="keyword">end subroutine read_xml_type_mat_xml_array</span>
<a name="l00345"></a>00345 
<a name="l00346"></a><a class="code" href="namespacexml__data__cmfd__t.html#a5ee441126ddc3adac07dabc8d941c2ec">00346</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a5ee441126ddc3adac07dabc8d941c2ec">read_xml_type_mat_xml</a>( info, starttag, endtag, attribs, noattribs, data, nodata, &amp;
<a name="l00347"></a>00347               dvar, has_dvar )
<a name="l00348"></a>00348    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00349"></a>00349    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: starttag
<a name="l00350"></a>00350    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                          :: endtag
<a name="l00351"></a>00351    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: attribs
<a name="l00352"></a>00352    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: noattribs
<a name="l00353"></a>00353    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>   :: data
<a name="l00354"></a>00354    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>                          :: nodata
<a name="l00355"></a>00355    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">intent(inout)</span>  :: dvar
<a name="l00356"></a>00356    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(inout)</span>                       :: has_dvar
<a name="l00357"></a>00357 
<a name="l00358"></a>00358    <span class="keywordtype">integer</span>                                      :: att_
<a name="l00359"></a>00359    <span class="keywordtype">integer</span>                                      :: noatt_
<a name="l00360"></a>00360    <span class="keywordtype">logical</span>                                      :: error
<a name="l00361"></a>00361    <span class="keywordtype">logical</span>                                      :: endtag_org
<a name="l00362"></a>00362    <span class="keywordtype">character(len=len(starttag))</span>                 :: tag
<a name="l00363"></a>00363    <span class="keywordtype">logical</span>                                         :: has_uid
<a name="l00364"></a>00364    <span class="keywordtype">logical</span>                                         :: has_totalxs
<a name="l00365"></a>00365    <span class="keywordtype">logical</span>                                         :: has_scattxs
<a name="l00366"></a>00366    <span class="keywordtype">logical</span>                                         :: has_nfissxs
<a name="l00367"></a>00367    <span class="keywordtype">logical</span>                                         :: has_diffcoef
<a name="l00368"></a>00368    <span class="keywordtype">logical</span>                                         :: has_chi
<a name="l00369"></a>00369    <span class="keywordtype">logical</span>                                         :: has_remxs
<a name="l00370"></a>00370    has_uid                              = .false.
<a name="l00371"></a>00371    has_totalxs                          = .false.
<a name="l00372"></a>00372    has_scattxs                          = .false.
<a name="l00373"></a>00373    has_nfissxs                          = .false.
<a name="l00374"></a>00374    has_diffcoef                         = .false.
<a name="l00375"></a>00375    has_chi                              = .false.
<a name="l00376"></a>00376    has_remxs                            = .false.
<a name="l00377"></a>00377    call <a class="code" href="namespacexml__data__cmfd__t.html#aa4f1dff7e09939f5d0958a29d62866e7">init_xml_type_mat_xml</a>(dvar)
<a name="l00378"></a>00378    has_dvar = .true.
<a name="l00379"></a>00379    error  = .false.
<a name="l00380"></a>00380    att_   = 0
<a name="l00381"></a>00381    noatt_ = noattribs+1
<a name="l00382"></a>00382    endtag_org = endtag
<a name="l00383"></a>00383    <span class="keyword">do</span>
<a name="l00384"></a>00384       <span class="keyword">if</span> ( nodata /= 0 ) <span class="keyword">then</span>
<a name="l00385"></a>00385          noattribs = 0
<a name="l00386"></a>00386          tag = starttag
<a name="l00387"></a>00387       elseif ( att_ &lt; noatt_ .and. noatt_ &gt; 1 ) <span class="keyword">then</span>
<a name="l00388"></a>00388          att_      = att_ + 1
<a name="l00389"></a>00389          <span class="keyword">if</span> ( att_ &lt;= noatt_-1 ) <span class="keyword">then</span>
<a name="l00390"></a>00390             tag       = attribs(1,att_)
<a name="l00391"></a>00391             <span class="keyword">data</span>(1)   = attribs(2,att_)
<a name="l00392"></a>00392             noattribs = 0
<a name="l00393"></a>00393             nodata    = 1
<a name="l00394"></a>00394             endtag    = .false.
<a name="l00395"></a>00395          <span class="keyword">else</span>
<a name="l00396"></a>00396             tag       = starttag
<a name="l00397"></a>00397             noattribs = 0
<a name="l00398"></a>00398             nodata    = 0
<a name="l00399"></a>00399             endtag    = .true.
<a name="l00400"></a>00400             cycle
<a name="l00401"></a>00401          <span class="keyword">endif</span>
<a name="l00402"></a>00402       <span class="keyword">else</span>
<a name="l00403"></a>00403          <span class="keyword">if</span> ( endtag_org ) <span class="keyword">then</span>
<a name="l00404"></a>00404             return
<a name="l00405"></a>00405          <span class="keyword">else</span>
<a name="l00406"></a>00406             call xml_get( info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata )
<a name="l00407"></a>00407             <span class="keyword">if</span> ( xml_error(info) ) <span class="keyword">then</span>
<a name="l00408"></a>00408                <span class="keyword">write</span>(<a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">lurep_</a>,*) <span class="stringliteral">&#39;Error reading input file!&#39;</span>
<a name="l00409"></a>00409                error = .true.
<a name="l00410"></a>00410                return
<a name="l00411"></a>00411             <span class="keyword">endif</span>
<a name="l00412"></a>00412          <span class="keyword">endif</span>
<a name="l00413"></a>00413       <span class="keyword">endif</span>
<a name="l00414"></a>00414       <span class="keyword">if</span> ( endtag .and. tag == starttag ) <span class="keyword">then</span>
<a name="l00415"></a>00415          exit
<a name="l00416"></a>00416       <span class="keyword">endif</span>
<a name="l00417"></a>00417       <span class="keyword">if</span> ( endtag .and. noattribs == 0 ) <span class="keyword">then</span>
<a name="l00418"></a>00418          <span class="keyword">if</span> ( xml_ok(info) ) <span class="keyword">then</span>
<a name="l00419"></a>00419             cycle
<a name="l00420"></a>00420          <span class="keyword">else</span>
<a name="l00421"></a>00421             exit
<a name="l00422"></a>00422          <span class="keyword">endif</span>
<a name="l00423"></a>00423       <span class="keyword">endif</span>
<a name="l00424"></a>00424       <span class="keyword">select</span> <span class="keyword">case</span>( tag )
<a name="l00425"></a>00425       <span class="keyword">case</span>(<span class="stringliteral">&#39;uid&#39;</span>)
<a name="l00426"></a>00426          call read_xml_integer( &amp;
<a name="l00427"></a>00427             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00428"></a>00428             dvar%uid, has_uid )
<a name="l00429"></a>00429       <span class="keyword">case</span>(<span class="stringliteral">&#39;totalxs&#39;</span>)
<a name="l00430"></a>00430          call read_xml_double_array( &amp;
<a name="l00431"></a>00431             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00432"></a>00432             dvar%totalxs, has_totalxs )
<a name="l00433"></a>00433       <span class="keyword">case</span>(<span class="stringliteral">&#39;scattxs&#39;</span>)
<a name="l00434"></a>00434          call read_xml_double_array( &amp;
<a name="l00435"></a>00435             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00436"></a>00436             dvar%scattxs, has_scattxs )
<a name="l00437"></a>00437       <span class="keyword">case</span>(<span class="stringliteral">&#39;nfissxs&#39;</span>)
<a name="l00438"></a>00438          call read_xml_double_array( &amp;
<a name="l00439"></a>00439             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00440"></a>00440             dvar%nfissxs, has_nfissxs )
<a name="l00441"></a>00441       <span class="keyword">case</span>(<span class="stringliteral">&#39;diffcoef&#39;</span>)
<a name="l00442"></a>00442          call read_xml_double_array( &amp;
<a name="l00443"></a>00443             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00444"></a>00444             dvar%diffcoef, has_diffcoef )
<a name="l00445"></a>00445       <span class="keyword">case</span>(<span class="stringliteral">&#39;chi&#39;</span>)
<a name="l00446"></a>00446          call read_xml_double_array( &amp;
<a name="l00447"></a>00447             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00448"></a>00448             dvar%chi, has_chi )
<a name="l00449"></a>00449       <span class="keyword">case</span>(<span class="stringliteral">&#39;remxs&#39;</span>)
<a name="l00450"></a>00450          call read_xml_double_array( &amp;
<a name="l00451"></a>00451             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00452"></a>00452             dvar%remxs, has_remxs )
<a name="l00453"></a>00453       <span class="keyword">case</span> (<span class="stringliteral">&#39;comment&#39;</span>, <span class="stringliteral">&#39;!--&#39;</span>)
<a name="l00454"></a>00454          <span class="comment">! Simply ignore</span>
<a name="l00455"></a>00455       <span class="keyword">case</span> default
<a name="l00456"></a>00456          <span class="keyword">if</span> ( <a class="code" href="namespacexml__data__cmfd__t.html#a5e231a5441a700d365de0bde8ff1b10a">strict_</a> ) <span class="keyword">then</span>
<a name="l00457"></a>00457             error = .true.
<a name="l00458"></a>00458             call xml_report_errors( info, &amp;
<a name="l00459"></a>00459                <span class="stringliteral">&#39;Unknown or wrongly placed tag: &#39;</span> // trim(tag))
<a name="l00460"></a>00460          <span class="keyword">endif</span>
<a name="l00461"></a>00461       <span class="keyword">end select</span>
<a name="l00462"></a>00462       nodata = 0
<a name="l00463"></a>00463       <span class="keyword">if</span> ( .not. xml_ok(info) ) exit
<a name="l00464"></a>00464    <span class="keyword">end do</span>
<a name="l00465"></a>00465    <span class="keyword">if</span> ( .not. has_uid ) <span class="keyword">then</span>
<a name="l00466"></a>00466       has_dvar = .false.
<a name="l00467"></a>00467       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on uid&#39;</span>)
<a name="l00468"></a>00468    <span class="keyword">endif</span>
<a name="l00469"></a>00469    <span class="keyword">if</span> ( .not. has_totalxs ) <span class="keyword">then</span>
<a name="l00470"></a>00470       has_dvar = .false.
<a name="l00471"></a>00471       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on totalxs&#39;</span>)
<a name="l00472"></a>00472    <span class="keyword">endif</span>
<a name="l00473"></a>00473    <span class="keyword">if</span> ( .not. has_scattxs ) <span class="keyword">then</span>
<a name="l00474"></a>00474       has_dvar = .false.
<a name="l00475"></a>00475       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on scattxs&#39;</span>)
<a name="l00476"></a>00476    <span class="keyword">endif</span>
<a name="l00477"></a>00477    <span class="keyword">if</span> ( .not. has_nfissxs ) <span class="keyword">then</span>
<a name="l00478"></a>00478       has_dvar = .false.
<a name="l00479"></a>00479       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on nfissxs&#39;</span>)
<a name="l00480"></a>00480    <span class="keyword">endif</span>
<a name="l00481"></a>00481    <span class="keyword">if</span> ( .not. has_diffcoef ) <span class="keyword">then</span>
<a name="l00482"></a>00482       has_dvar = .false.
<a name="l00483"></a>00483       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on diffcoef&#39;</span>)
<a name="l00484"></a>00484    <span class="keyword">endif</span>
<a name="l00485"></a>00485    <span class="keyword">if</span> ( .not. has_chi ) <span class="keyword">then</span>
<a name="l00486"></a>00486       has_dvar = .false.
<a name="l00487"></a>00487       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on chi&#39;</span>)
<a name="l00488"></a>00488    <span class="keyword">endif</span>
<a name="l00489"></a>00489    <span class="keyword">if</span> ( .not. has_remxs ) <span class="keyword">then</span>
<a name="l00490"></a>00490       has_dvar = .false.
<a name="l00491"></a>00491       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on remxs&#39;</span>)
<a name="l00492"></a>00492    <span class="keyword">endif</span>
<a name="l00493"></a>00493 <span class="keyword">end subroutine read_xml_type_mat_xml</span>
<a name="l00494"></a><a class="code" href="namespacexml__data__cmfd__t.html#a5764fa4184f32068c51a07dbfbdec2db">00494</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a5764fa4184f32068c51a07dbfbdec2db">init_xml_type_mat_xml_array</a>( dvar )
<a name="l00495"></a>00495    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">pointer</span> :: dvar
<a name="l00496"></a>00496    <span class="keyword">if</span> ( <span class="keyword">associated</span>( dvar ) ) <span class="keyword">then</span>
<a name="l00497"></a>00497       <span class="keyword">deallocate</span>( dvar )
<a name="l00498"></a>00498    <span class="keyword">endif</span>
<a name="l00499"></a>00499    <span class="keyword">allocate</span>( dvar(0) )
<a name="l00500"></a>00500 <span class="keyword">end subroutine init_xml_type_mat_xml_array</span>
<a name="l00501"></a><a class="code" href="namespacexml__data__cmfd__t.html#aa4f1dff7e09939f5d0958a29d62866e7">00501</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#aa4f1dff7e09939f5d0958a29d62866e7">init_xml_type_mat_xml</a>(dvar)
<a name="l00502"></a>00502    <span class="keywordtype">type(mat_xml)</span> :: dvar
<a name="l00503"></a>00503 <span class="keyword">end subroutine init_xml_type_mat_xml</span>
<a name="l00504"></a><a class="code" href="namespacexml__data__cmfd__t.html#af0c3e513d9dc9a36fe5e8a24c86f8e45">00504</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#af0c3e513d9dc9a36fe5e8a24c86f8e45">write_xml_type_mat_xml_array</a>( &amp;
<a name="l00505"></a>00505       info, tag, indent, dvar )
<a name="l00506"></a>00506    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00507"></a>00507    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: tag
<a name="l00508"></a>00508    <span class="keywordtype">integer</span>                                         :: indent
<a name="l00509"></a>00509    <span class="keywordtype">type(mat_xml)</span>, <span class="keywordtype">dimension(:)</span>        :: dvar
<a name="l00510"></a>00510    <span class="keywordtype">integer</span>                                         :: i
<a name="l00511"></a>00511    <span class="keyword">do</span> i = 1,<span class="keyword">size</span>(dvar)
<a name="l00512"></a>00512        call <a class="code" href="namespacexml__data__cmfd__t.html#aedd8b56861b712e79196af863b57bee1">write_xml_type_mat_xml</a>( info, tag, indent, dvar(i) )
<a name="l00513"></a>00513    <span class="keyword">enddo</span>
<a name="l00514"></a>00514 <span class="keyword">end subroutine write_xml_type_mat_xml_array</span>
<a name="l00515"></a>00515 
<a name="l00516"></a><a class="code" href="namespacexml__data__cmfd__t.html#aedd8b56861b712e79196af863b57bee1">00516</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#aedd8b56861b712e79196af863b57bee1">write_xml_type_mat_xml</a>( &amp;
<a name="l00517"></a>00517       info, tag, indent, dvar )
<a name="l00518"></a>00518    <span class="keywordtype">type(XML_PARSE)</span>                                 :: info
<a name="l00519"></a>00519    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>                    :: tag
<a name="l00520"></a>00520    <span class="keywordtype">integer</span>                                         :: indent
<a name="l00521"></a>00521    <span class="keywordtype">type(mat_xml)</span>                      :: dvar
<a name="l00522"></a>00522    <span class="keywordtype">character(len=100)</span>                              :: indentation
<a name="l00523"></a>00523    indentation = <span class="stringliteral">&#39; &#39;</span>
<a name="l00524"></a>00524    <span class="keyword">write</span>(info%lun, <span class="stringliteral">&#39;(4a)&#39;</span> ) indentation(1:min(indent,100)),&amp;
<a name="l00525"></a>00525        <span class="stringliteral">&#39;&lt;&#39;</span>,trim(tag), <span class="stringliteral">&#39;&gt;&#39;</span>
<a name="l00526"></a>00526    call write_to_xml_integer( info, <span class="stringliteral">&#39;uid&#39;</span>, indent+3, dvar%uid)
<a name="l00527"></a>00527    call write_to_xml_double_array( info, <span class="stringliteral">&#39;totalxs&#39;</span>, indent+3, dvar%totalxs)
<a name="l00528"></a>00528    call write_to_xml_double_array( info, <span class="stringliteral">&#39;scattxs&#39;</span>, indent+3, dvar%scattxs)
<a name="l00529"></a>00529    call write_to_xml_double_array( info, <span class="stringliteral">&#39;nfissxs&#39;</span>, indent+3, dvar%nfissxs)
<a name="l00530"></a>00530    call write_to_xml_double_array( info, <span class="stringliteral">&#39;diffcoef&#39;</span>, indent+3, dvar%diffcoef)
<a name="l00531"></a>00531    call write_to_xml_double_array( info, <span class="stringliteral">&#39;chi&#39;</span>, indent+3, dvar%chi)
<a name="l00532"></a>00532    call write_to_xml_double_array( info, <span class="stringliteral">&#39;remxs&#39;</span>, indent+3, dvar%remxs)
<a name="l00533"></a>00533    <span class="keyword">write</span>(info%lun,<span class="stringliteral">&#39;(4a)&#39;</span>) indentation(1:min(indent,100)), &amp;
<a name="l00534"></a>00534        <span class="stringliteral">&#39;&lt;/&#39;</span> //trim(tag) // <span class="stringliteral">&#39;&gt;&#39;</span>
<a name="l00535"></a>00535 <span class="keyword">end subroutine write_xml_type_mat_xml</span>
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="namespacexml__data__cmfd__t.html#a4fc8acac147815d553cffe8d15e084a2">00537</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a4fc8acac147815d553cffe8d15e084a2">read_xml_file_cmfd_t</a>(fname, lurep, errout)
<a name="l00538"></a>00538    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>           :: fname
<a name="l00539"></a>00539    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>          :: lurep
<a name="l00540"></a>00540    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span>         :: errout
<a name="l00541"></a>00541 
<a name="l00542"></a>00542    <span class="keywordtype">type(XML_PARSE)</span>                        :: info
<a name="l00543"></a>00543    <span class="keywordtype">logical</span>                                :: error
<a name="l00544"></a>00544    <span class="keywordtype">character(len=80)</span>                      :: tag
<a name="l00545"></a>00545    <span class="keywordtype">character(len=80)</span>                      :: starttag
<a name="l00546"></a>00546    <span class="keywordtype">logical</span>                                :: endtag
<a name="l00547"></a>00547    <span class="keywordtype">character(len=80)</span>, <span class="keywordtype">dimension(1:2,1:20)</span> :: attribs
<a name="l00548"></a>00548    <span class="keywordtype">integer</span>                                :: noattribs
<a name="l00549"></a>00549    <span class="keywordtype">character(len=200)</span>, <span class="keywordtype">dimension(1:100)</span>   :: data
<a name="l00550"></a>00550    <span class="keywordtype">integer</span>                                :: nodata
<a name="l00551"></a>00551    <span class="keywordtype">logical</span>                                         :: has_geometry
<a name="l00552"></a>00552    <span class="keywordtype">logical</span>                                         :: has_mat
<a name="l00553"></a>00553    has_geometry                         = .false.
<a name="l00554"></a>00554    has_mat                              = .false.
<a name="l00555"></a>00555    <span class="keyword">allocate</span>(<a class="code" href="namespacexml__data__cmfd__t.html#a2aa66ea95cd00522b90f06cbcb13baab">mat</a>(0))
<a name="l00556"></a>00556 
<a name="l00557"></a>00557    call <a class="code" href="namespacexml__data__cmfd__t.html#a75f6916c88b7127bb0940d9837d38cde">init_xml_file_cmfd_t</a>
<a name="l00558"></a>00558    call xml_open( info, fname, .true. )
<a name="l00559"></a>00559    call xml_options( info, report_errors=.false., ignore_whitespace=.true.)
<a name="l00560"></a>00560    <a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">lurep_</a> = 0
<a name="l00561"></a>00561    <span class="keyword">if</span> ( present(lurep) ) <span class="keyword">then</span>
<a name="l00562"></a>00562       <a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">lurep_</a> = lurep
<a name="l00563"></a>00563       call xml_options( info, report_lun=lurep )
<a name="l00564"></a>00564    <span class="keyword">endif</span>
<a name="l00565"></a>00565    <span class="keyword">do</span>
<a name="l00566"></a>00566       call xml_get( info, starttag, endtag, attribs, noattribs, &amp;
<a name="l00567"></a>00567          <span class="keyword">data</span>, nodata)
<a name="l00568"></a>00568       <span class="keyword">if</span> ( starttag /= <span class="stringliteral">&#39;!--&#39;</span> ) exit
<a name="l00569"></a>00569    <span class="keyword">enddo</span>
<a name="l00570"></a>00570    <span class="keyword">if</span> ( starttag /= <span class="stringliteral">&quot;cmfd&quot;</span> ) <span class="keyword">then</span>
<a name="l00571"></a>00571       call xml_report_errors( info, &amp;
<a name="l00572"></a>00572          <span class="stringliteral">&#39;XML-file should have root element &quot;cmfd&quot;&#39;</span>)
<a name="l00573"></a>00573       error = .true.
<a name="l00574"></a>00574       call xml_close(info)
<a name="l00575"></a>00575       return
<a name="l00576"></a>00576    <span class="keyword">endif</span>
<a name="l00577"></a>00577    <a class="code" href="namespacexml__data__cmfd__t.html#a5e231a5441a700d365de0bde8ff1b10a">strict_</a> = .false.
<a name="l00578"></a>00578    error = .false.
<a name="l00579"></a>00579    <span class="keyword">do</span>
<a name="l00580"></a>00580       call xml_get( info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata )
<a name="l00581"></a>00581       <span class="keyword">if</span> ( xml_error(info) ) <span class="keyword">then</span>
<a name="l00582"></a>00582          <span class="keyword">write</span>(<a class="code" href="namespacexml__data__cmfd__t.html#ade5d101adbeedb8fa86cbd5e8715374a">lurep_</a>,*) <span class="stringliteral">&#39;Error reading input file!&#39;</span>
<a name="l00583"></a>00583          error = .true.
<a name="l00584"></a>00584          return
<a name="l00585"></a>00585       <span class="keyword">endif</span>
<a name="l00586"></a>00586       <span class="keyword">if</span> ( endtag .and. tag == starttag ) <span class="keyword">then</span>
<a name="l00587"></a>00587          exit
<a name="l00588"></a>00588       <span class="keyword">endif</span>
<a name="l00589"></a>00589       <span class="keyword">if</span> ( endtag .and. noattribs == 0 ) <span class="keyword">then</span>
<a name="l00590"></a>00590          <span class="keyword">if</span> ( xml_ok(info) ) <span class="keyword">then</span>
<a name="l00591"></a>00591             cycle
<a name="l00592"></a>00592          <span class="keyword">else</span>
<a name="l00593"></a>00593             exit
<a name="l00594"></a>00594          <span class="keyword">endif</span>
<a name="l00595"></a>00595       <span class="keyword">endif</span>
<a name="l00596"></a>00596       <span class="keyword">select</span> <span class="keyword">case</span>( tag )
<a name="l00597"></a>00597       <span class="keyword">case</span>(<span class="stringliteral">&#39;geometry&#39;</span>)
<a name="l00598"></a>00598          call <a class="code" href="namespacexml__data__cmfd__t.html#a7bed203907e75d7172c9531371471832">read_xml_type_geometry_xml</a>( &amp;
<a name="l00599"></a>00599             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00600"></a>00600             <a class="code" href="namespacexml__data__cmfd__t.html#a56a655f48acfec2ce36e98deadce83f8">geometry</a>, has_geometry )
<a name="l00601"></a>00601       <span class="keyword">case</span>(<span class="stringliteral">&#39;mat&#39;</span>)
<a name="l00602"></a>00602          call <a class="code" href="namespacexml__data__cmfd__t.html#aa6889fdae9a646681ce5e8040ebe18f3">read_xml_type_mat_xml_array</a>( &amp;
<a name="l00603"></a>00603             info, tag, endtag, attribs, noattribs, <span class="keyword">data</span>, nodata, &amp;
<a name="l00604"></a>00604             <a class="code" href="namespacexml__data__cmfd__t.html#a2aa66ea95cd00522b90f06cbcb13baab">mat</a>, has_mat )
<a name="l00605"></a>00605       <span class="keyword">case</span> (<span class="stringliteral">&#39;comment&#39;</span>, <span class="stringliteral">&#39;!--&#39;</span>)
<a name="l00606"></a>00606          <span class="comment">! Simply ignore</span>
<a name="l00607"></a>00607       <span class="keyword">case</span> default
<a name="l00608"></a>00608          <span class="keyword">if</span> ( <a class="code" href="namespacexml__data__cmfd__t.html#a5e231a5441a700d365de0bde8ff1b10a">strict_</a> ) <span class="keyword">then</span>
<a name="l00609"></a>00609             error = .true.
<a name="l00610"></a>00610             call xml_report_errors( info, &amp;
<a name="l00611"></a>00611                <span class="stringliteral">&#39;Unknown or wrongly placed tag: &#39;</span> // trim(tag))
<a name="l00612"></a>00612          <span class="keyword">endif</span>
<a name="l00613"></a>00613       <span class="keyword">end select</span>
<a name="l00614"></a>00614       nodata = 0
<a name="l00615"></a>00615       <span class="keyword">if</span> ( .not. xml_ok(info) ) exit
<a name="l00616"></a>00616    <span class="keyword">end do</span>
<a name="l00617"></a>00617    <span class="keyword">if</span> ( .not. has_geometry ) <span class="keyword">then</span>
<a name="l00618"></a>00618       error = .true.
<a name="l00619"></a>00619       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on geometry&#39;</span>)
<a name="l00620"></a>00620    <span class="keyword">endif</span>
<a name="l00621"></a>00621    <span class="keyword">if</span> ( .not. has_mat ) <span class="keyword">then</span>
<a name="l00622"></a>00622       error = .true.
<a name="l00623"></a>00623       call xml_report_errors(info, <span class="stringliteral">&#39;Missing data on mat&#39;</span>)
<a name="l00624"></a>00624    <span class="keyword">endif</span>
<a name="l00625"></a>00625    <span class="keyword">if</span> ( present(errout) ) errout = error
<a name="l00626"></a>00626 <span class="keyword">end subroutine</span>
<a name="l00627"></a>00627 
<a name="l00628"></a><a class="code" href="namespacexml__data__cmfd__t.html#a61b1f8ce11aab1db2f11fb9184a970db">00628</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a61b1f8ce11aab1db2f11fb9184a970db">write_xml_file_cmfd_t</a>(fname, lurep)
<a name="l00629"></a>00629    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>           :: fname
<a name="l00630"></a>00630    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span>          :: lurep
<a name="l00631"></a>00631 
<a name="l00632"></a>00632    <span class="keywordtype">type(XML_PARSE)</span>                        :: info
<a name="l00633"></a>00633    <span class="keywordtype">integer</span>                                :: indent = 0
<a name="l00634"></a>00634 
<a name="l00635"></a>00635    call xml_open( info, fname, .false. )
<a name="l00636"></a>00636    call xml_options( info, report_errors=.true.)
<a name="l00637"></a>00637    <span class="keyword">if</span> ( present(lurep) ) <span class="keyword">then</span>
<a name="l00638"></a>00638        call xml_options( info, report_errors=.true.)
<a name="l00639"></a>00639    <span class="keyword">endif</span>
<a name="l00640"></a>00640    <span class="keyword">write</span>(info%lun,<span class="stringliteral">&#39;(a)&#39;</span>) &amp;
<a name="l00641"></a>00641       <span class="stringliteral">&#39;&lt;cmfd&gt;&#39;</span>
<a name="l00642"></a>00642    call <a class="code" href="namespacexml__data__cmfd__t.html#ab1767278ec3e20d9e79cdbebe03ff933">write_xml_type_geometry_xml</a>( info, <span class="stringliteral">&#39;geometry&#39;</span>, indent+3, <a class="code" href="namespacexml__data__cmfd__t.html#a56a655f48acfec2ce36e98deadce83f8">geometry</a>)
<a name="l00643"></a>00643    call <a class="code" href="namespacexml__data__cmfd__t.html#af0c3e513d9dc9a36fe5e8a24c86f8e45">write_xml_type_mat_xml_array</a>( info, <span class="stringliteral">&#39;mat&#39;</span>, indent+3, <a class="code" href="namespacexml__data__cmfd__t.html#a2aa66ea95cd00522b90f06cbcb13baab">mat</a>)
<a name="l00644"></a>00644    <span class="keyword">write</span>(info%lun,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;&lt;/cmfd&gt;&#39;</span>
<a name="l00645"></a>00645    call xml_close(info)
<a name="l00646"></a>00646 <span class="keyword">end subroutine</span>
<a name="l00647"></a>00647 
<a name="l00648"></a><a class="code" href="namespacexml__data__cmfd__t.html#a75f6916c88b7127bb0940d9837d38cde">00648</a> <span class="keyword">subroutine </span><a class="code" href="namespacexml__data__cmfd__t.html#a75f6916c88b7127bb0940d9837d38cde">init_xml_file_cmfd_t</a>
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 <span class="keyword">end subroutine</span>
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 <span class="keyword">end module</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Feb 20 2012 20:20:05 for CMFD by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
