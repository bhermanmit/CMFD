program = cmfd

#===============================================================================
# PETSc/SLEPc files
#===============================================================================

  include ${SLEPC_DIR}/conf/slepc_common

#===============================================================================
# Object Files
#===============================================================================

include OBJECTS

#===============================================================================
# User Options
#===============================================================================

DEBUG = yes

#==============================================================================
# Set Options
#==============================================================================

F90FLAGS = -I../lib/intel -I${PETSC_DIR}/include -I${SLEPC_DIR}/include
LDFLAGS  = -L../lib/intel -lxmlparse ${SLEPC_LIB}


ifeq ($(DEBUG),yes)

  F90FLAGS += -g -ftrapuv -fp-stack-check -check all -fpe0
  LDFLAGS  += -g

endif

#===============================================================================
# Targets
#===============================================================================

all: $(program)
$(program): $(objects) chkopts
	${FLINKER} $(objects) -o $@ $(LDFLAGS)

clean::
	@rm cmfd

#===============================================================================
# Rules
#===============================================================================

.SUFFIXES: .F90 .o
.PHONY: all clean neat

%.o: %.F90
	${FLINKER} $(F90FLAGS) -c $<

#===============================================================================
# Dependencies
#===============================================================================

include DEPENDENCIES
