program = cmfd

#===============================================================================
# Environmental Variables
#===============================================================================

export PETSC_DIR=/mnt/md0/Documents/Documents/PhD/petsc
export PETSC_ARCH=arc-linux2-c-nodebug

#===============================================================================
# PETSc files
#===============================================================================

include ${PETSC_DIR}/conf/variables
include ${PETSC_DIR}/conf/rules

#===============================================================================
# Object Files
#===============================================================================

include OBJECTS

#===============================================================================

# F90FLAGS = -I${PETSC_DIR}/include/finclude -I../lib/gfortran -ffree#-form
# F90FLAGS = -I../lib/gfortran -ffree-form -fbacktrace -g -fbounds-check
  F90FLAGS = -I../lib/gfortran -ffree-form
  LDFLAGS = -L../lib/gfortran -lxmlparse

#===============================================================================
# Targets
#===============================================================================

all: $(program)
$(program): $(objects) chkopts
	${FLINKER} $(objects) -o $@ $(LDFLAGS) ${PETSC_SYS_LIB}

#===============================================================================
# Rules
#===============================================================================

.SUFFIXES: .f90 .o
.PHONY: all clean neat

%.o: %.f90
	${FLINKER} $(F90FLAGS) -c $<

#===============================================================================
# Dependencies
#===============================================================================

include DEPENDENCIES
