program = cmfd

#===============================================================================
# Environmenal Variables
#===============================================================================

export PETSC_DIR=/mnt/md0/Documents/Documents/PhD/petsc31
export PETSC_ARCH=debug

#===============================================================================
# Slepc files
#===============================================================================

include ${SLEPC_DIR}/conf/slepc_common

#===============================================================================
# Object Files
#===============================================================================

include OBJECTS

#===============================================================================

# F90FLAGS = -I${PETSC_DIR}/include/finclude -I../lib/gfortran -ffree#-form
# F90FLAGS = -I../lib/gfortran -ffree-form -fbacktrace -g -fbounds-check
  F90FLAGS = -I../lib/gfortran -ffree-form
  LDFLAGS = -L../lib/gfortran -lxmlparse

#===============================================================================
# Targets
#===============================================================================

all: $(program)
$(program): $(objects) chkopts
	${FLINKER} $(objects) -o $@ $(LDFLAGS) ${SLEPC_LIB}

#===============================================================================
# Rules
#===============================================================================

.SUFFIXES: .f90 .o
.PHONY: all clean neat

%.o: %.f90
	${FLINKER} $(F90FLAGS) -c $<

#===============================================================================
# Dependencies
#===============================================================================

include DEPENDENCIES
